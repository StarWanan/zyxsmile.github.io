<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="开放世界语义分割    开集语义分割模块    闭集语义分割子模块    异常分割子模块   增量小样本学习模块  我是短小精悍的文章摘要(๑•̀ㅂ•́) ✧">
<meta property="og:type" content="article">
<meta property="og:title" content="DMLNet">
<meta property="og:url" content="http://example.com/2022/05/03/DMLNet/index.html">
<meta property="og:site_name" content="Star">
<meta property="og:description" content="开放世界语义分割    开集语义分割模块    闭集语义分割子模块    异常分割子模块   增量小样本学习模块  我是短小精悍的文章摘要(๑•̀ㅂ•́) ✧">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220427093204641.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420232032090.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420110759366.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420113236739.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220424181213091.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220421080547891.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220421080604032.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220424132323338.png">
<meta property="og:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220422113413245.png">
<meta property="article:published_time" content="2022-05-03T12:07:00.000Z">
<meta property="article:modified_time" content="2022-05-03T12:08:54.342Z">
<meta property="article:author" content="Star">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220427093204641.png">

<link rel="canonical" href="http://example.com/2022/05/03/DMLNet/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>DMLNet | Star</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Star</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">有棱有角，还会发光；努力生活，星之煌煌～</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/03/DMLNet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Star">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Star">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DMLNet
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-05-03 20:07:00 / Modified: 20:08:54" itemprop="dateCreated datePublished" datetime="2022-05-03T20:07:00+08:00">2022-05-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>开放世界语义分割  </p>
<ul>
<li>开集语义分割模块   <ul>
<li>闭集语义分割子模块   </li>
<li>异常分割子模块</li>
</ul>
</li>
<li>增量小样本学习模块</li>
</ul>
<p>我是短小精悍的文章摘要(๑•̀ㅂ•́) ✧</p>
<span id="more"></span>

<h1 id="CODE"><a href="#CODE" class="headerlink" title="CODE"></a>CODE</h1><p>multiscale 是自己设定的吗 <code>cfg.DATASET.imgSizes = (300, 375, 450, 525, 600)</code></p>
<p>Seg 转化为long Tensor的目的是什么</p>
<p>colors的作用是什么</p>
<p>几个辅助函数的作用：</p>
<p><code>Normalization(x)</code>: $\dfrac{x - min(x)}{max(x) - min(x)}$ </p>
<p><code>Coefficient_map(x, thre)</code>: $\dfrac{1}{1 + exp(50*(x - thre))}$</p>
<p><code>normfun(x, mu, sigma)</code>:$\dfrac{exp(-\frac{(x - mu)^2}{2 * \sigma^2})}{\sigma * \sqrt{2*\pi}}$</p>
<h1 id="论文阅读"><a href="#论文阅读" class="headerlink" title="论文阅读"></a>论文阅读</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>Classical close-set semantic segmentation networks have limited ability to detect out-of-distribution (OOD) objects, which is important for safety-critical applications such as autonomous driving. Incrementally learning these OOD objects with few annotations is an ideal way to enlarge the knowledge base of the deep learning models. In this paper, we propose an open world semantic segmenta- tion system that includes two modules: </p>
<p>(1) &#x3D;&#x3D;an open-set semantic segmentation module to detect both in-distribution and OOD objects&#x3D;&#x3D;.</p>
<p>(2) an incremental few-shot learning module to gradually incorporate those OOD objects into its existing knowledge base. </p>
<p>This open world semantic segmentation system behaves like a human being, which is able to identify OOD objects and gradually learn them <strong>with corresponding supervision</strong>. </p>
<p>We adopt the &#x3D;&#x3D;Deep Metric Learning Network (DMLNet) with contrastive clustering&#x3D;&#x3D; to implement open-set semantic segmentation. Compared to other open-set semantic segmentation methods, our DMLNet achieves state-of-the-art performance on three challenging open-set semantic segmentation datasets without using additional data or generative models. </p>
<p>On this basis, two incremental few-shot learning methods are fur- ther proposed to progressively improve the DMLNet with the annotations of OOD objects</p>
<hr>
<p>经典的闭集语义分割网络检测分布外 (OOD) 对象的能力有限，这对于自动驾驶等安全关键型应用很重要。 增量学习这些带有少量注释的 OOD 对象是扩大深度学习模型知识库的理想方法。 在本文中，我们提出了一个开放世界语义分割系统，包括两个模块：</p>
<p>(1) <strong>一个开放集语义分割模块，用于检测内分布和OOD对象。</strong>  </p>
<p><del>(2) 一个增量的小样本学习模块，逐渐将这些 OOD 对象纳入其现有的知识库。</del> </p>
<p>这个开放世界的语义分割系统就像一个人，能够识别OOD对象并在相应的监督下逐渐学习它们。 </p>
<p>我们采用具有&#x3D;&#x3D;对比聚类的深度度量学习网络（DMLNet）&#x3D;&#x3D;来实现开放集语义分割。 与其他开放集语义分割方法相比，我们的 DMLNet 在三个具有挑战性的开放集语义分割数据集上实现了最先进的性能，而无需使用额外的数据或生成模型。 </p>
<p><del>在此基础上，进一步提出了两种增量少样本学习方法，通过 OOD 对象的注释逐步改进 DMLNet</del></p>
<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6. Conclusion"></a>6. Conclusion</h2><p>We introduce an open world semantic segmentation system which incorporates two modules: </p>
<ul>
<li>an open-set segmentation module </li>
<li>an incremental few-shot learning module.</li>
</ul>
<p>Our proposed open-set segmentation module is based on the <strong>deep metric learning network</strong>, and it uses the <strong>Euclidean distance sum</strong> criterion to achieve state-of-the-art performance. </p>
<p>Two incremental few-shot learning methods are proposed to broaden the perception knowledge of the network. Both modules of the open world semantic segmentation system can be further studied to improve the performance. We hope our work can draw more researchers to contribute to this practically valuable research direction.</p>
<hr>
<p>我们介绍了一个开放世界语义分割系统，它包含两个模块：一个开放集分割模块和一个增量小样本学习模块。 </p>
<p>我们提出的开放集分割模块基于深度度量学习网络，它使用&#x3D;&#x3D;欧几里德距离和标准&#x3D;&#x3D;来实现最先进的性能。 </p>
<p>提出了两种增量少样本学习方法来拓宽网络的感知知识。 开放世界语义分割系统的两个模块都可以进一步研究以提高性能。 我们希望我们的工作能够吸引更多的研究人员为这个具有实际价值的研究方向做出贡献</p>
<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h2><p>得益于高质量的数据集 [3,4,5]，深度卷积网络在语义分割任务 [1, 2] 中取得了巨大成功。 这些语义分割网络在许多应用中被用作感知系统，如自动驾驶[6]、医疗诊断[7]等。然而，这些感知系统中的大多数都是闭集和静态的。 闭集语义分割假设测试中的所有类都已经在训练期间参与，这在开放世界中是不正确的。 如果闭集系统错误地将分发中标签分配给 OOD 对象 [8]，它可能会在安全关键型应用程序（如自动驾驶）中造成灾难性后果。 同时，静态感知系统无法根据所见内容更新其知识库，因此，它仅限于特定场景，需要在一定时间后重新训练。 为了解决这些问题，我们提出了一种开放集的动态感知系统，称为开放世界语义分割系统。 它包含两个模块：  </p>
<p>（1）一个开放集语义分割模块，用于检测OOD对象并将正确的标签分配给分布中的对象。</p>
<p>  (2) 一个增量的小样本学习模块，将这些未知对象逐步合并到其现有的知识库中。</p>
<p>  我们提出的开放世界语义分割系统的整个流程如<strong>图 1</strong> 所示  </p>
<p>开放集语义分割和增量小样本学习都没有得到很好的解决。 </p>
<p>对于开集语义分割，最重要的部分是在一张图像的所有像素中识别OOD像素，称为异常分割。 异常分割的典型方法是将图像级的开集分类方法应用于像素级的开集分类。 </p>
<p>这些方法包括基于不确定性估计的方法 [9, 10, 11, 12] 和基于自动编码器的方法 [13, 14]。 然而，这两种方法已被证明在驾驶场景中无效，因为基于不确定性估计的方法&#x3D;&#x3D;会给出许多假阳性异常值检测&#x3D;&#x3D; [15] 并且自动编码器&#x3D;&#x3D;无法重新生成复杂的城市场景&#x3D;&#x3D; [16]。 最近，基于生成对抗网络（基于 GAN）的方法 [16, 17] 已被证明是有效的，但它们远&#x3D;&#x3D;非轻量级&#x3D;&#x3D;，因为它们需要在管道中使用多个深度网络。 </p>
<p>对于增量少样本学习，我们不仅要处理增量学习的挑战，例如灾难性遗忘[18]，还要处理少样本学习的挑战，包括从少量样本中提取代表性特征[19]  </p>
<p>在本文中，我们建议使用 DMLNet 来解决开放世界语义分割问题。 原因有三：  </p>
<p>(1) DMLNet的分类原理是基于<strong>对比聚类</strong>，可以有效识别异常物体，如<strong>图2</strong>所示<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220427093204641.png" alt="image-20220427093204641" style="zoom:50%;" /></p>
<blockquote>
<p>度量学习：从数据中学习一种度量数据对象间距离的方法。其目标是使得在学得的距离度量下，相似对象间的距离小，不相似对象间的距离大。</p>
<p>传统的度量学习方法只能学习出线性特征，虽然有一些能够提取非线性特征的核方法被提出，但对学习效果也没有明显提升</p>
<p>深度度量学习：深度学习的激活函数学习非线性特征的优秀能力，深度学习方法能够自动地从原始数据中学出高质量的特征。因此深度学习的网络结构与传统的度量学习方法相结合能够带来理想的效果。</p>
</blockquote>
<p><del>(2) DMLNet结合原型非常适合few-shot 任务[19]。</del>    </p>
<p><del>(3) DMLNet 的增量学习可以通过添加新的原型来实现，这是一种自然而有用的方法 [20]。</del></p>
<p> 基于 DMLNet 架构，我们为开放集语义分割模块开发了两种未知识别标准，为增量少样本学习模块开发了两种方法。</p>
<p>   根据我们的实验，这两个模块都被验证为有效且轻量级的。 总而言之，我们的贡献如下：    </p>
<ul>
<li>我们率先推出开放世界语义分割系统，在实际应用中更加稳健实用。</li>
<li>我们提出的基于 DMLNet 的开放集语义分割模块在三个具有挑战性的数据集上实现了最先进的性能。</li>
<li>我们提出的few-shot 增量学习模块方法在很大程度上缓解了灾难性遗忘问题。</li>
<li>通过结合我们提出的开放集语义分割模块和增量少样本学习模块，实现了一个开放世界语义分割系统。</li>
</ul>
<h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h2><h4 id="2-1-异常语义分割"><a href="#2-1-异常语义分割" class="headerlink" title="2.1 异常语义分割"></a>2.1 异常语义分割</h4><p>异常语义分割的方法可以分为两种趋势：  基于不确定性估计的方法和基于生成模型的方法。</p>
<p>不确定性估计的基线是最大softmax概率（MSP），它首先在[9]中提出。  Dan 等人没有使用 softmax 概率。  [11]提出使用最大logit（MaxLogit）并取得更好的异常分割性能。 贝叶斯网络采用深度学习网络的概率观点，所以它们的权重和输出是概率分布而不是特定的数字 [21, 22]。 在实践中，Dropout [10] 或集成 [12] 通常用于近似贝叶斯推理。 </p>
<p>自动编码器（AE）[23, 13] 和 RBM [14] 是典型的生成方法，假设 OOD 图像的重建误差大于分布内图像  </p>
<p>最近，另一种基于 GAN 再合成的生成模型被证明可以基于其可靠的高分辨率像素到像素转换结果实现最先进的性能。  SynthCP [17] 和 DUIR [16] 是基于 GAN 再合成的两种方法。 不幸的是，它们离轻量级还很远，因为必须依次使用两个或三个神经网络来进行 OOD 检测。 </p>
<p>与它们相比，我们证明了基于对比聚类的 DMLNet 具有更好的异常分割性能，而只需要推理一次  </p>
<h4 id="2-2-深度度量学习网络"><a href="#2-2-深度度量学习网络" class="headerlink" title="2.2 深度度量学习网络"></a>2.2 深度度量学习网络</h4><p>DMLNets 已用于多种应用，包括视频理解 [24] 和人员重新识别 [25]。  DMLNet 使用欧几里得、马氏距离或 Matusita 距离 [26] 将此类问题转换为计算度量空间中的嵌入特征相似度。</p>
<p><strong>卷积原型网络和 DMLNets</strong> 通常一起用于解决特定问题，例如检测图像级 OOD 样本 [27、28、29] 和用于语义分割的小样本学习 [19、30、31]。 我们也按照这种组合构建了第一个用于开放世界语义分割的 DMLNet  </p>
<h4 id="2-3-开放世界分类和检测"><a href="#2-3-开放世界分类和检测" class="headerlink" title="2.3 开放世界分类和检测"></a>2.3 开放世界分类和检测</h4><p>开放世界分类首先由 [32] 提出。这项工作提出了最近非异常值 (NNO) 算法，该算法在增量添加对象类别、检测异常值和管理开放空间风险方面非常有效。<br>    最近约瑟夫等人。  [33]提出了一种基于对比聚类、未知感知提议网络和基于能量的未知识别标准的开放世界对象检测系统。 我们的开放世界语义分割系统的管道与他们的相似，除了两个重要的区别使我们的任务更具挑战性：（1）在他们的开放集检测模块中，他们依赖于区域提议网络（RPN）是 类不可知，因此也可以检测到未标记的潜在 OOD 对象。 这样，OOD样本的信息对于训练是有效的。 但是，我们专注于语义分割，其中训练中使用的每个像素都被分配了一个分布内标签，因此<strong>不能将 OOD 样本添加到训练中</strong>。  (2) 在增量学习模块中，他们使用新类的所有标记数据，而我们专注于自然更困难的少样本条件。 很少有研究集中在增量小样本学习上，其中包括用于分类的增量小样本学习[34]、对象检测[35]和语义分割[36]</p>
<h2 id="3-开放世界语义分割"><a href="#3-开放世界语义分割" class="headerlink" title="3. 开放世界语义分割"></a>3. 开放世界语义分割</h2><p>在本节中，我们给出了开放世界语义分割系统的工作流程。 该系统由一个开放集语义分割模块和一个增量小样本学习模块组成。 假设 $\mathcal{C}<em>{in} &#x3D; {\mathcal{C}</em>{in,1},\mathcal{C}<em>{in,2},…,\mathcal{C}</em>{in,N} } $ 是 N 个分布内的类，它们都在训练数据集中进行了注释，并且 $\mathcal{C}<em>{out} &#x3D; {\mathcal{C}</em>{out,1},\mathcal{C}<em>{out,2},…,\mathcal{C}</em>{out,M} } $ 是训练数据集中没有遇到的 M 个 OOD 类  </p>
<p><strong>开集语义分割模块</strong>又分为两个子模块：<strong>闭集语义分割子模</strong>块和<strong>异常分割子模块</strong>。 </p>
<ul>
<li>$\hat{Y}^{close}$ 是闭集语义分割子模块的输出图，所以每个像素的类别 $\hat{Y}^{close}<em>{i,j} ∈ C</em>{in}$。 </li>
<li>异常分割子模块的功能是识别OOD像素，其输出称为异常概率图：$\hat{P} \in [1,0]^{H \times W}$，其中 $H$ 和 $W$ 表示输入图像的高度和宽度。</li>
</ul>
<p>基于 $\hat{Y}<em>{close}$ 和 $\hat{P}$，开集语义分割图 $\hat{Y}^{open}$ 给出为:<br>$$<br>\hat{Y}^{open}</em>{i,j} &#x3D;<br>\begin{cases}<br>\mathcal{C}<em>{anomaly} \quad \     \hat{P}</em>{i,j} &gt; \lambda_{out} \<br>\hat{Y}<em>{i,j}^{close} \quad \quad \hat{P}</em>{i,j} \le \lambda_{out}<br>\end{cases} \tag{1}<br>$$<br>$\mathcal{C}<em>{anomaly}$ ：表示 OOD 类别<br>$λ</em>{out}$ ：确定 OOD 像素的阈值。</p>
<p>因此，openset语义分割模块应该识别OOD像素并分配正确的分布标签。然后 Yopen 可以转发给可以从 Cout 中识别 Canomaly 并给出新类的相应注释的标注者  增量少样本学习模块用于在有新标签时将近集分割子模块的知识库从 Cin 一个一个更新为 Cin+M，其中 Cin+t &#x3D; Cin ∪ {Cout,1,Cout,  2,…,Cout,t},t ∈{1,2,…,M}。 <strong>图 1</strong> 显示了开放世界语义分割系统的循环工作流水线 </p>
<p>图 1. 开放世界语义分割系统。 第 1 步：识别已知和未知对象（蓝色箭头）。 第 2 步：注释未知对象（红色箭头）。 第 3 步：应用增量少样本学习来增加网络的分类范围（绿色箭头）。 第 4 步：在增量少样本学习之后，DMLNet 可以在更大的域中输出结果（紫色箭头）。<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420232032090.png" alt="image-20220420232032090"></p>
<h2 id="4-方法"><a href="#4-方法" class="headerlink" title="4. 方法"></a>4. 方法</h2><p>我们采用 DMLNet 作为我们的特征提取器，并在 4.1 节讨论架构和损失函数。 开放集分割模块和增量少样本学习模块在 4.2 和 4.3 节中进行了说明</p>
<h3 id="4-1-深度度量学习网络"><a href="#4-1-深度度量学习网络" class="headerlink" title="4.1 深度度量学习网络"></a>4.1 深度度量学习网络</h3><blockquote>
<p>Classical CNN-based semantic segmentation networks can be disentangled into two parts: </p>
<ul>
<li>a feature extractor $f(X;θ_f)$ for obtaining the embedding vector of each pixel </li>
<li>a classifier $g(f(X;θ_f);θ_g)$ for generating the decision boundary,</li>
</ul>
<p>where $X$, $θ_f$ and $θ_g$ denote the <strong>input image</strong>, <strong>parameters</strong> of the feature extractor and classifier respectively. </p>
<p>This learnable classifier is not suitable for OOD detection because it assigns all feature space to known classes and leaves no space for OOD classes. </p>
</blockquote>
<p>传统CNN-based语义分割网络：</p>
<ul>
<li>$f(X;\theta_f)$ 特征提取器：获取每个像素的嵌入向量</li>
<li>$g(f(X;\theta_f);\theta_g)$ 分类器：生成决策边界</li>
</ul>
<p>这种&#x3D;&#x3D;可学习的分类器不适用于 OOD 检测&#x3D;&#x3D;，因为它将所有特征空间分配给已知类，并且没有为 OOD 类留下空间。 </p>
<blockquote>
<p>In contrast, the classifier is replaced by the Euclidean distance representation with all prototypes $\mathcal{M}<em>{in} &#x3D; { m_t \in \mathbb{R}^{1 \times N}|t \in {1,2,…,N}  }$ in DMLNet, where $m_t$ refers to the prototype of class $\mathcal{C}</em>{in,t}$. The feature extractor $f(X;θ_f)$ learns to map the input $X$ to the feature vector which has the same length as the prototype in metric space. For the close-set segmentation task, the probability of one pixel $X_{i,j}$ belonging to the class $\mathcal{C}_{in,t}$ is formulated as:</p>
</blockquote>
<p>DMLNet 中, &#x3D;&#x3D;所有原型的欧几里得距离&#x3D;&#x3D;表示代替了传统的可学习分类器</p>
<ul>
<li>$m_t$ 指的是 $\mathcal{C}_{in,t}$ 类的原型。</li>
</ul>
<p>特征提取器 $f(X;θ_f)$学习将输入 X 映射到与度量空间中的原型长度相同的特征向量。 </p>
<p>对于闭集分割任务，一个像素 $X_{i,j}$ 属于类 $\mathcal{C}<em>{in,t}$ 的概率公式为：<br>$$<br>p_t(X</em>{i,j}) &#x3D; \frac{exp(-||f(X;\theta_f)<em>{i,j} - m_t||^2)}{\sum^N</em>{t’&#x3D;1} exp(-||f(X;\theta_f)<em>{i,j} - m</em>{t’}||^2)} \tag{2}<br>$$</p>
<p>基于这种基于欧几里德距离的概率，<strong>判别交叉熵 (DCE)</strong> 损失函数 $\mathcal{L}<em>{DCE}(X</em>{i,j},Y_{i,j};θ_f,M_{in})$ [27] 定义为:<br>$$<br>\mathcal{L}<em>{DCE} &#x3D; \sum</em>{i,j} -log (\frac{exp(-||f(X;\theta_f)<em>{i,j} - m</em>{Y_{i,j}}||^2)}{\sum^N_{k&#x3D;1} exp(-||f(X;\theta_f)<em>{i,j} - m</em>{k}||^2)} \tag{3}<br>$$</p>
<p>$Y$：输入图像 $X$ 的标签<br>$\mathcal{L}_{DCE}$ 的分子和分母分别指图2中的吸引力和排斥力。 </p>
<blockquote>
<p>排斥力不需要除去本身所属的类，本身类的原型吗？</p>
</blockquote>
<p>图 2. DMLNet 的对比聚类。 在推理过程中，已知对象将被同一类的原型所吸引，而被剩余的原型所排斥。 最后，它们将围绕特定的原型进行聚合。 相反，异常对象将被所有原型排斥，因此它们将聚集在度量空间的中间。</p>
<img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420110759366.png" alt="image-20220420110759366" style="zoom:20%;" />

<p>我们制定了另一个损失函数，称为<strong>方差损失 (VL)</strong> 函数 $\mathcal{L}<em>{VL}(X</em>{i,j},Y_{i,j};θ_f,M_{in})$，其定义为：<br>$$<br>\mathcal{L}<em>{VL} &#x3D; \sum</em>{i,j} ||f(X;\theta_f)<em>{i,j} - m</em>{Y_{i,j}}||^2 \tag{4}<br>$$<br>$\mathcal{L}_{VL}$ 只有吸引力作用，没有排斥力作用。 </p>
<p>使用 DCE 和 VL，混合损失定义为：$\mathcal{L}&#x3D; \mathcal{L}<em>{DCE} + λ</em>{VL}\mathcal{L}<em>{VL}$，其中 $λ</em>{VL}$ 是权重参数</p>
<h3 id="4-2-开集语义分割模型"><a href="#4-2-开集语义分割模型" class="headerlink" title="4.2 开集语义分割模型"></a>4.2 开集语义分割模型</h3><p>开集语义分割模块由闭集语义分割子模块和异常分割子模块组成。 开放集语义分割模块的流程如 图3 所示。</p>
<p><strong>图3</strong>.闭集分割子模块包含在蓝色虚线框内，异常分割子模块包含在红色虚线框内。 开集分割图是这两个子模块生成的结果的组合。 在开放集分割图中预测分布内类和 OOD 类。  EDS map 和 MMSP map 的定义请参考 4.2 节。<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220420113236739.png" alt="image-20220420113236739"></p>
<ul>
<li><p><strong>闭集语义分割子模块</strong>为一幅图像的所有像素分配分布标签。 由于一个像素 $X_{i,j}$ 属于类 $\mathcal{C}<em>{in,t}$ 的概率是用公式 2 表示，闭集分割图为：<br>$$<br>\hat{Y}</em>{i,j}^{close} &#x3D; argmax_t \ p_t(X_{i,j}) \tag{5}<br>$$</p>
</li>
<li><p><strong>异常分割子模块</strong>检测OOD像素。 我们提出了两个未知的识别标准来测量异常概率，包括_基于度量的最大softmax概率（MMSP）_和_欧几里得距离和（EDS）_。 </p>
<ul>
<li><p>以下是基于 MMSP 的异常概率：<br>$$<br>\hat{P}^{MMSP}<em>{i,j} &#x3D; 1 - max \ p_t(X</em>{i,j}),\ t \in { 1,2,3…,N } \tag{6}<br>$$</p>
</li>
<li><p>EDS 是根据以下发现提出的：如果特征位于 OOD 像素聚集的度量空间的中心，则与所有原型的欧几里得距离和更小，即&#x3D;&#x3D;异常的欧几里得距离较小&#x3D;&#x3D;。  EDS 定义为：<br>$$<br>S(X_{i,j}) &#x3D; \sum_{t&#x3D;1}^N ||f(X;\theta_f)<em>{i,j} - m_t||^2 \tag{7}<br>$$<br>基于 EDS 的异常概率计算如下：<br>$$<br>\hat{P}^{EDS}</em>{i,j} &#x3D; 1- \frac{S(X_{i,j})}{maxS(X)} \tag{8}<br>$$</p>
</li>
</ul>
</li>
</ul>
<p>EDS 是类独立的，因此所有类的原型应该均匀分布在度量空间中，并且在训练期间不移动。 &#x3D;&#x3D;可学习的原型会在训练期间导致不稳定，并且对更好的性能没有贡献&#x3D;&#x3D; [37]。 因此，我们以 one-hot 向量形式定义原型：只有 $m_t$ 的第 t 个元素是 $T$，而其他元素保持为零，其中 t ∈ {1,2,…,N}</p>
<blockquote>
<p>PAnS是什么情况？</p>
</blockquote>
<p>EDS 是相对于所有像素之间的最大距离和的比率，即使图像中没有 OOD 对象，高异常分数区域肯定存在于每幅图像中。 此外，每个分布内类别的距离总和分布彼此略有不同，如图4所示。<img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220424181213091.png" alt="image-20220424181213091" style="zoom:50%;" /></p>
<p>将MMSP与EDS相结合，以抑制那些实际上处于分布状态的具有中间响应的像素。</p>
<p>混合函数为：<br>$$<br>\hat{P} &#x3D; \alpha \hat{P}^{EDS} + (1-\alpha)\hat{P}^{MMSP} \tag{9}<br>$$</p>
<ul>
<li><p>α ：<br>$$<br>\alpha &#x3D; \frac{1}{1 + exp(-\beta(\hat{P}^{EDS} - \gamma))} \tag{10}<br>$$</p>
<ul>
<li>β 和 γ 是控制抑制效果和阈值的超参数。</li>
</ul>
</li>
</ul>
<p>通过方程 9 得到异常概率图和方程 5 得到闭集分割图后，我们应用方程 1 生成最终的开集分割图</p>
<h2 id="5-实验"><a href="#5-实验" class="headerlink" title="5. 实验"></a>5. 实验</h2><p>Our experiments are divided into three parts. </p>
<ul>
<li>We first evaluate our open-set semantic segmentation approach in Section 5.1. </li>
<li><del>Then we demonstrate our incremental few-shot learning results in Section 5.2.</del> </li>
<li><del>Based on the open-set semantic segmentation module and incremental few-show learning module, the whole open world semantic segmentation is realized in Section 5.3.</del></li>
</ul>
<h3 id="5-1-开集语义分割"><a href="#5-1-开集语义分割" class="headerlink" title="5.1 开集语义分割"></a>5.1 开集语义分割</h3><p> <strong>数据集</strong>。 三个数据集包括 StreetHazards [11]、Lost and Found [38] 和 Road Anomaly [16] 用于证明我们基于 DMLNet 的开放集语义分割方法的稳健性和有效性。  </p>
<ul>
<li>StreetHazards 的大多数异常物体是大型稀有运输机器，例如直升机、飞机和拖拉机。 </li>
<li>Lost and Found 含许多小的异常物品，如货物、玩具和盒子。  </li>
<li>Road Anomaly 数据集不再限制城市场景中的场景，还包含村庄和山脉的图像。</li>
</ul>
<p> <strong>指标</strong>。 开放集语义分割是封闭集分割和异常分割的组合，如 4.2 节所述。 </p>
<ul>
<li>对于闭集语义分割任务，我们使用 mIoU 来评估性能。</li>
<li>对于异常分割任务，根据 [11] 使用三个指标，包括 ROC 曲线下面积（AUROC）、95% 召回的误报率（FPR95）和精确召回曲线下面积（AUPR）。</li>
</ul>
<p><strong>实施细节</strong>。 </p>
<ul>
<li><p>对于 StreetHazards，我们遵循与 [11] 相同的训练程序，在 StreetHazards 的训练集上训练 PSPNet [2]。 </p>
<blockquote>
<p>[11]: Scaling out-of-distribution detection for real-world settings.</p>
</blockquote>
</li>
<li><p>对于Lost and Found和 Road Anomaly，我们按照 [16] 使用 BDD-100k [39] 来训练 PSPNet。 请注意，PSPNet 仅用于提取我们在 4.1 节中讨论的特征（获得每个像素的嵌入向量）。 混合损失的 $λ_{VL}$ 为 0.01。   所有原型中非零元素 $T$ 为 3。等式 10 中的 β 和 γ 分别为 20 和 0.8。</p>
<blockquote>
<p>[16]: Detecting the unexpected via image resynthesis</p>
</blockquote>
</li>
</ul>
<p><strong>基线</strong>。 </p>
<ul>
<li>StreetHazards:  MSP [9]、Dropout [10]、AE [13]、MaxLogit [11] 和 SynthCP [17]。 </li>
<li>Lost and Found 和 Road Anomaly:  MSP、MaxLogit、Ensemble [12]、RBM [14] 和 DUIR [16]。</li>
</ul>
<p><strong>结果</strong>。</p>
<p>StreetHazards 的结果如表 1 所示。<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220421080547891.png" alt="image-20220421080547891"></p>
<p>对于 Lost and Found 和 Road Anomaly，mIoU 是无效的，因为它们只提供 OOD 类标签，但没有特定的分布内类标签。 结果在表 2 中。<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220421080604032.png" alt="image-20220421080604032"></p>
<p>我们的实验表明：</p>
<ul>
<li>基于 DMLNet 的方法在所有三个异常分割相关指标中都达到了最先进的性能。 </li>
<li>与最近提出的基于 GAN 的方法（包括 DUIR 和 SynthCP）相比，我们的方法在异常分割质量方面优于它们，结构更轻量级，因为它们在整个流程中需要两个或三个深度神经网络，而我们只需要推理一次。  </li>
<li>StreetHazards 中闭集分割的 mIoU 值表明我们的方法对闭集分割没有危害。</li>
</ul>
<p>一些定性结果如图 8 所示<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220424132323338.png" alt="image-20220424132323338"></p>
<p><strong>消融研究</strong>。 我们仔细进行了消融实验，研究了不同损失函数（VL 和 DCE）和异常判断标准（EDS 和 MMSP）的影响，如表 3 所示。<br><img src="https://gitee.com/zyxstar/Pic_bed/raw/master/image/image-20220422113413245.png" alt="image-20220422113413245" style="zoom:50%;" /></p>
<ul>
<li>DCE 在 mIoU 上的性能优于 VL 的事实表明了 排斥力。  </li>
<li>EDS 在所有损失下都优于 MMSP 函数，这意味着&#x3D;&#x3D;与类无关的标准更适合于异常分割任务&#x3D;&#x3D;</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/03/%E4%B8%80%E7%B1%BB%E5%B5%8C%E5%85%A5%E5%8F%8D%E5%90%91%E8%92%B8%E9%A6%8F/" rel="prev" title="DMLNet">
      <i class="fa fa-chevron-left"></i> DMLNet
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CODE"><span class="nav-number">1.</span> <span class="nav-text">CODE</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB"><span class="nav-number">2.</span> <span class="nav-text">论文阅读</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">2.1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Conclusion"><span class="nav-number">2.2.</span> <span class="nav-text">6. Conclusion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.3.</span> <span class="nav-text">1. 介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Related-Work"><span class="nav-number">2.4.</span> <span class="nav-text">2. Related Work</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E5%BC%82%E5%B8%B8%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2"><span class="nav-number">2.4.0.1.</span> <span class="nav-text">2.1 异常语义分割</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E6%B7%B1%E5%BA%A6%E5%BA%A6%E9%87%8F%E5%AD%A6%E4%B9%A0%E7%BD%91%E7%BB%9C"><span class="nav-number">2.4.0.2.</span> <span class="nav-text">2.2 深度度量学习网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-%E5%BC%80%E6%94%BE%E4%B8%96%E7%95%8C%E5%88%86%E7%B1%BB%E5%92%8C%E6%A3%80%E6%B5%8B"><span class="nav-number">2.4.0.3.</span> <span class="nav-text">2.3 开放世界分类和检测</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%BC%80%E6%94%BE%E4%B8%96%E7%95%8C%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2"><span class="nav-number">2.5.</span> <span class="nav-text">3. 开放世界语义分割</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%96%B9%E6%B3%95"><span class="nav-number">2.6.</span> <span class="nav-text">4. 方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E6%B7%B1%E5%BA%A6%E5%BA%A6%E9%87%8F%E5%AD%A6%E4%B9%A0%E7%BD%91%E7%BB%9C"><span class="nav-number">2.6.1.</span> <span class="nav-text">4.1 深度度量学习网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%BC%80%E9%9B%86%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.6.2.</span> <span class="nav-text">4.2 开集语义分割模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%AE%9E%E9%AA%8C"><span class="nav-number">2.7.</span> <span class="nav-text">5. 实验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E5%BC%80%E9%9B%86%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2"><span class="nav-number">2.7.1.</span> <span class="nav-text">5.1 开集语义分割</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Star</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Star</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
